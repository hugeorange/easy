# 简单的HTTP协议

## 2.1 HTTP协议用于客户端和服务器端之间的通信

- `HTTP协议`和`TCP/IP协议族`内的其他众多协议相同，用于 `客户端和服务器之间的通信` 。

## 2.2 通过请求和响应的交换达成通信

- HTTP协议自身不具备保存之前发送过的请求或响应的功能。

## 2.3 HTTP是不保存状态的协议
- 协议本身并不保留之前一切的请求或响应报文的信息，这是为了更快地处理大量事务，确保协议的可伸缩性，而特意把HTTP协议设计如此间的。

## 2.4 请求URI定位资源

- HTTP协议使用 URI 定位互联网上的资源。正是因为 URI 的特定功能，在互联网上任意位置的资源都能访问到。

## 2.5 告知服务器意图的 HTTP 方法

- GET 获取资源

- POST 传输实体主体

- PUT 传输文件

- HEAD 获得报文首部
	* HEAD 方法与GET方法一样，只是不返回报文主体部分。用于确认URI的有效性及资源更新的日期时间等。

- DELETE 方法用来删除文件，是与PUT相反的方法。DELETE方法按请求URI删除指定的资源
	* 由于 PUT、DELETE 本身不带验证机制所以很少使用。

- OPTIONS 询问支持的方法
	* OPTIONS 方法用来查询针对请求URI指定的资源支持的方法 （可能返回：GET,PUT,POST,HEAD...）

- TRACE 追踪路径
	* TRACE方法是让web服务器端将之前的请求通信环回给客户端的方法
	* 客户端通过TRACE方法可以查询发送出去的请求是怎样被加工修改/窜改的。这是因为，请求想要连接到源目标服务器可能会通过代理中转，TRACE方法就是用来确认连接过程中发生的一些列操作。
	* 但是，TRACE方法不常用且容易引发 XST （Cross-Site Tracing，跨站追踪）攻击

- CONNECT 要求用隧道协议连接代理
	* CONNECT方法要求在与代理服务器通信时建立隧道，实现用隧道协议进行TCP通信。主要是用SSL（Secure Sockets Layer,安全套接层）和TLS（Transport Layer Security，传输层安全）协议把通信内容加密后经网络隧道传输。 
	* CONNECT方法的格式如下所示： `CONNECT 代理服务器：端口号HTTP版本`

## 2.6 使用方法下达命令
- 向请求URI指定的资源发送请求报文时，采用称为方法的命令。
- 方法的作用在于，可以指定请求的资源按期望产生某种行为。方法中有GET、POST和HEAD等。

方法 | 说明 | 支持的HTTP协议的版本 
- | :-: | -: 
GET | 获取资源| 1.0 1.1 
POST | 传输实体主体 | 1.0 1.1
PUT | 传输文件 | 1.0 1.1
HEAD | 获得报文首部 | 1.0 1.1
DELETE | 删除文件 | 1.0 1.1
OPTIONS | 询问支持的方法 | 1.1
TRACE | 追踪路径 | 1.1
CONNECT | 要求用隧道协议连接代理 | 1.1
LINK | 建立和资源之间的联系 | 1.0
UNLINK | 断开连接关系 | 1.0

LINK和UNLINK已被HTTP/1.1废弃


## 2.7 持久连接节省通信量

- HTTP协议的初始版本中，每进行一次HTTP通信就要断开一次TCP连接。
- 例如：请求一个包含各种资源（图片、js、css等）的HTML资源，需要进行多次的HTTP请求，就需要多次断开TCP、连接TCP

### 2.7.1 持久连接
- 未解决上述 TCP 连接的问题，HTTP/1.1 和一部分的HTTP/1.0 想出了持久连接（HTTP Persistent Connections，也称为HTTP keep-alive 或 HTTP connection resure）的方法。持久的连接的特点是，只要任意一端没有明确提出断开连接，则保持TCP连接状态。
- 持久连接的好处在于少了TCP连接的重复建立和断开所造成的额外开销，减轻了服务端的负载。另外，减少开销的那部分时间，使HTTP请求和响应能够更早地结束，这样Web页面的显示速度也就相应提高了。
- HTTP/1.1中，所有的连接默认都是持久连接

### 2.7.2 管线化
- 持久连接使得多数请求以管线化（pipelining）方式发送成为可能。从前发送请求后需等待并收到响应，才能发送下一个请求。管线化技术出现后，不用等待响应亦可直接发送下一个请求。
- 这样就能够做到同时并行发送多个请求，而不需要一个接一个地等待响应了

- 比如，当请求一个包含10张图片的 HTML web页面，与挨个连接相比，用持久连接可以让请求更快结束。而管线化技术则比持久连接还要快。请求数越多，时间差就越明显。

## 使用 COOKIE 的状态管理
- HTTP是无状态协议，它不对之前发生过的请求和响应的状态进行管理。也就是说，无法根据之前的状态进行本次请求处理。
- 不可否认，无状态协议当然也有它的优点。由于不必保存状态，自然可减少服务器的cpu及内存资源的消耗。从另一侧面来说，也正是因为HTTP协议本身是非常简单的，所以才会被应用在各种场景里。
- 保留无状态协议这个特征的同时又要解决类似的矛盾问题，于是引入了Cookie技术。Cookie技术通过在请求和响应报文中写入 Cookie 信息来控制客户端的状态。
- COOKIE 交互的场景
- 客户端 --> (请求报文，没有Cookie信息的状态) --> 服务端 --> 响应报文（服务端生成Cookie信息）--> 客户端的第二次请求（自动发送保存着的Cookie信息） --> 服务端通过cookie识别客户端的身份。












